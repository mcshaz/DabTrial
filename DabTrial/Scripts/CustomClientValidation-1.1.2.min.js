(function(n){function t(n,t,i){n.rules[t]=i,n.message&&(n.messages[t]=n.message)}function l(t,i,r){for(var u=0,f;u<r.length;u++)f=u==0?i:i+u,t.messages[f]=r[u].message,delete r[u].message,t.rules[f]=r[u],i!==f&&function e(){var t=0;if(!n.validator.methods[i]){if(++t>10)throw new ReferenceError(i+" is not defined");setTimeout(e,100);return}n.validator.methods[f]||n.validator.addMethod(f,n.validator.methods[i])}()}function a(t){var o=n.parseJSON(t.message),u=[],f,i,e=0,r,s=[];for(f in t.params)t.params.hasOwnProperty(f)&&(i={},i.key=f,i.vals=n.parseJSON(t.params[f]),u.push(i));for(;e<o.length;e++){for(i={},i.message=o[e],r=0;r<u.length;r++)i[u[r].key]=u[r].vals[e];s.push(i)}return s}function v(t){return typeof(f==="undefined")&&(f=document.getElementsByTagName("form")),"form"+n.inArray(t,f)}function r(n){return n.substr(0,n.lastIndexOf(".")+1)}function i(n,t){return n.indexOf("*.")===0&&(n=n.replace("*.",t)),n}function y(t,i){return n(document.getElementsByName(t)).map(function(n,r){return r.form==i&&r.name==t&&r||null})}function e(n,t){for(var i="pending",r=0,u=(n.files||[]).length;r<u&&i!==!1;)i=t.call(n,n.files[r]),r+=1;return i}function p(n){var t=/(\d{4})-([01]\d)-([0-3]\d)T([0-2]\d):([0-5]\d):([0-5]\d)/.exec(n),i;return t===null?null:(i=new Date(n),isNaN(i)&&(i=new Date(t[1],parseInt(t[2])-1,t[3],t[4],t[5],t[6])),i)}function s(n,t,i){var r,u,f;return i==="M"||i==="Y"?(r=(t.getFullYear()-n.getFullYear())*12+t.getMonth()-n.getMonth(),u=t.getDate()-n.getDate(),u>0?r+=u/h(t.getFullYear(),t.getMonth()+1):u<0&&(r+=u/h(t.getFullYear(),t.getMonth())),i==="M"?r:r/12):(f=o[i],(t.getTime()-n.getTime())/f)}function h(n,t){return new Date(t,n,0).getDate()}function c(n,t){if(t=parseInt(t,10),isNaN(t))throw new TypeError("weeksGestationAtBirth Must be a valid integer");if(t>=43||t<23)throw new RangeError("weeksGestationAtBirth Must be between 23 and 42");return s(n,new Date,"w")+t}var f,u,o;jQuery.validator.addMethod("dateITA",function(n,t){var a=!1,i=/^(\d{1,2})\/(\d{1,2})\/(\d{4})( ?(\d{1,2}):(\d{1,2})(:(\d{1,2}))?(:(\d{1,}))?)?( ?([aApP])\.?[mM]\.?)?$/.exec(n),f,e,o,u,s,h,c,r,l;return i&&i.length>4&&(f=parseInt(i[1],10),e=parseInt(i[2],10),o=parseInt(i[3],10),u=parseInt(i[5]||0,10),l=(i[12]||"").toLowerCase(),u===12&&l==="a"?u-=12:u!==12&&l==="p"&&(u+=12),s=parseInt(i[6]||0,10),h=parseInt(i[8]||0,10),c=parseInt(i[10]||0,10),r=new Date(o,e-1,f,u,s,h,c),a=r.getFullYear()===o&&r.getMonth()===e-1&&r.getDate()===f&&r.getHours()===u&&r.getMinutes()===s&&r.getSeconds()===h&&r.getMilliseconds()===c),this.optional(t)||a},"Please enter a correct date"),n.validator.methods.date=n.validator.methods.dateITA,n.validator.unobtrusive.adapters.addBool("mustbetrue","required"),n.validator.addMethod("isvalidregex",function(n){try{var t=new RegExp(n)}catch(i){return!1}return!0}),n.validator.unobtrusive.adapters.addBool("isvalidregex"),n.validator.addMethod("maxfilesize",function(n,t,i){return e(t,function(n){return n.size<i})}),n.validator.unobtrusive.adapters.add("maxfilesize",["size"],function(n){t(n,"maxfilesize",parseInt(n.params.size,10))}),n.validator.addMethod("filetypes",function(t,i,r){var u=/\.[^.]+$/;return e(i,function(t){var i=u.exec(t.name);return i&&n.inArray(i[0].substr(1),r)>-1})}),n.validator.unobtrusive.adapters.add("filetypes",["types"],function(n){var i=n.params.types.split(",");n.message=n.message.replace("{0}",i.join(", ")),t(n,"filetypes",i)}),n.validator.addMethod("datetonow",function(t,i,r){var u=parseDate(n(i)),f=new Date;return isNaN(u)?"pending":r==="before"?u<f:u>f}),n.validator.unobtrusive.adapters.addSingleVal("datetonow","opt"),n.validator.addMethod("regexcount",function(n,t,i){var r=(n.match(i.regex)||[]).length;return r>=i.min&&r<=i.max}),n.validator.unobtrusive.adapters.add("regexcount",["min","max","regex","regexopt"],function(n){for(var t=a(n),i=0;i<t.length;i++)t[i].regex=new RegExp(t[i].regex,t[i].regexopt),delete t[i].regexopt;l(n,"regexcount",t)}),n.validator.addMethod("comesafter",function(n,t,i){var i=parseDate(i),r=parseDate(t);return!r||!i?"pending":r>=i}),n.validator.addMethod("comesbefore",function(n,t,i){var i=parseDate(i),r=parseDate(t);return!r||!i?"pending":r<=i}),n.validator.unobtrusive.adapters.add("comesbefore",["otherdateprop","comparisondate"],function(u){if(u.params.otherdateprop){var f=r(u.element.name),e=i(u.params.otherdateprop,f),o=n(u.form).find(":input[name='"+e+"']:first");t(u,"comesbefore",o)}else t(u,"comesbefore",u.params.comparisondate)}),n.validator.unobtrusive.adapters.add("comesafter",["otherdateprop","comparisondate"],function(u){if(u.params.otherdateprop){var f=r(u.element.name),e=i(u.params.otherdateprop,f),o=n(u.form).find(":input[name='"+e+"']:first");t(u,"comesafter",o)}else t(u,"comesafter",u.params.comparisondate)}),n.validator.addMethod("dateinterval",function(t,i,r){var u=r.$otherdate?parseDate(r.$otherdate):new Date,f=parseDate(n(i));return!u||isNaN(u)||!f||isNaN(f)?"pending":(interval=s(f,u,r.timeunit),interval>=r.mininterval&&interval<=r.maxinterval)}),n.validator.unobtrusive.adapters.add("dateinterval",["otherdateprop","min","max","unit"],function(u){var f=u.params.otherdateprop,e={mininterval:parseInt(u.params.min,10),maxinterval:parseInt(u.params.max,10),timeunit:u.params.unit},o,s;f&&(o=r(u.element.name),s=i(f,o),e.$otherdate=n(u.form).find(":input[name='"+s+"']:first")),t(u,"dateinterval",e)}),n.validator.addMethod("trueonlyif",function(n,t,i){var r=function(){var t=this.value,n=this.type;return n&&(n==="radio"||n==="checkbox")&&!this.checked?!1:i.othervals.indexOf(t)>-1};return!t.checked||i.$otherprop.is(r)}),n.validator.unobtrusive.adapters.add("trueonlyif",["otherprop","othervals"],function(u){var e=u.params.otherprop,f={othervals:u.params.othervals.split("||")},o=r(u.element.name),s=i(e,o);f.$otherprop=n(u.form).find(":input[name='"+s+"']"),t(u,"trueonlyif",f)}),n.validator.addMethod("cgarange",function(t,i,r){var f=parseDate(n(i)),e=r.weeksGestEl.value||40,u;return isNaN(f)||!e?"pending":(u=c(f,e),u>=r.min&&u<=r.max)}),n.validator.unobtrusive.adapters.add("cgarange",["min","max","weeksgestationprop"],function(u){var f={min:parseInt(u.params.min,10),max:parseInt(u.params.max,10)},e=r(u.element.name),o=i(u.params.weeksgestationprop,e);f.weeksGestEl=n(u.form).find(":input[name='"+o+"']")[0],t(u,"cgarange",f)}),n.validator.addMethod("wt4age",function(t,i,r){function o(){var n=parseDate(r.$dob),t=r.$weeksGest[0].value||40,u;return(f=r.$gender.not(":not(:checked)").val()===r.maleVal,isNaN(n)||!t||!(typeof f=="boolean"))?"pending":(u=c(n,t),gausDist.zWtForAge(i.value,u,f))}function s(){return"<span class='field-validation-error'>"+gausDist.suggestedDeviationMsg(u)+"<\/span> healthy"+(f?" males":" females")+" of the same age weigh "+(u>0?"more":"less")}function h(){function h(){u=o(),n.inArray(this,r.$gender)>-1&&(f=r.$gender.not(":not(:checked)").val()===r.maleVal),t.html(s())}var t=n("#confirmWtWarnMsg");if(t.length)return h(),e.show(400),document.getElementById("confirmWtWarnOk").checked;t=n("<div id='wtWarnContainer' style='display:none'><label><input type='checkbox' id='confirmWtWarnOk' class='input-validation-error' />Confirm weight is correct - <span id='confirmWtWarnMsg'>"+s()+"<\/span><\/label><\/div>").insertAfter(".field-validation-valid[data-valmsg-for='"+i.name+"'],.field-validation-error[data-valmsg-for='"+i.name+"']").show(400).find("#confirmWtWarnMsg");r.$weeksGest.add(r.$gender).add(r.$dob).on("change",h);return!1}var f,u=o(),e=n("#wtWarnContainer");return u=="pending"?"pending":-r.zfail>u||u>r.zfail?(e.hide(),!1):-r.zwarn<u&&u<r.zwarn?(e.hide(),!0):h()}),n.validator.unobtrusive.adapters.add("wtforage",["zwarn","zfail","dobprop","weeksgestationprop","genderprop","maleval"],function(u){var e={zfail:parseFloat(u.params.zfail,10),zwarn:u.params.zwarn?parseFloat(u.params.zwarn,10):Number.MAX_VALUE,maleVal:u.params.maleval},o=r(u.element.name),f=i(u.params.weeksgestationprop,o);e.$weeksGest=n(u.form).find(":input[name='"+f+"']"),f=i(u.params.dobprop,o),e.$dob=n(u.form).find(":input[name='"+f+"']"),f=i(u.params.genderprop,o),e.$gender=n(u.form).find(":input[name='"+f+"']"),t(u,"wt4age",e)}),n.validator.addMethod("requiredgroup",function(n,t,i){for(var r=0;r<i.length;r++)if(i[r].checked===!0)return!0;return!1}),u=[],n.validator.unobtrusive.adapters.add("requiredgroup",function(n){var r=n.element.name,i=v(n.form)+r;u[i]||(u[i]=y(r,n.form)),t(n,"requiredgroup",u[i])}),o={s:1e3,m:6e4,h:36e5,d:864e5,w:6048e5},window.parseDate=function(t){var e,r,o=/\bhasDatepicker\b/,u,i,f;if(t instanceof Date)return t;if(t.tagName){if(o.test(t.className))return n(t).datepicker("getDate");r=t.value}else if(t instanceof jQuery){if(!t.length)return null;if(o.test(t[0].className))return t.datepicker("getDate");r=t.val()}else if(typeof t=="string")r=t;else throw new TypeError("invalid dateArg - must be a DOM element, jQuery element, date or string representation of a date");if(!r)return null;if(e=p(r),!e){if(u=/^([0-3]?\d)\/([0-1]?\d)\/([1-2]\d{3})/.exec(r),u==null||!u.length)return null;e=new Date(u[3],u[2]-1,u[1]),i=r.substr(u[0].length+1).split(":"),i.length>1&&(f=/([ap])\.?m?\.?$/i.exec(i[i.length-1]),f&&f.length&&(f[1].toLowerCase()==="p"&&i[0]<12?i[0]+=12:f[1].toLowerCase()==="a"&&i[0]==12&&(i[0]=0),i[i.length-1]=i[i.length-1].substr(0,i[i.length-1].length-f[0].length)),e.setHours(i[0],i[1]||0,i[2]||0,i[3]||0))}return e}})(jQuery)